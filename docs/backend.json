{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the DCAM Classes system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the user."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "photoURL": {
          "type": "string",
          "description": "URL or data URI for the user's profile picture."
        },
        "roleId": {
          "type": "string",
          "description": "Reference to Role. (Relationship: Role 1:N User)"
        },
        "classLevel": {
          "type": "string",
          "description": "The class level of the student, if applicable.",
          "enum": [
            "Class 11",
            "Class 12",
            "Dropper"
          ]
        },
        "subscriptionPlanId": {
          "type": "string",
          "description": "The ID of the user's active subscription plan. Reference to SubscriptionPlan."
        },
        "subscriptionStatus": {
          "type": "string",
          "description": "The current status of the user's subscription.",
          "enum": [
            "active",
            "canceled",
            "past_due",
            "trialing"
          ]
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "roleId"
      ]
    },
    "Role": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Role",
      "type": "object",
      "description": "Represents the role of a user in the system (e.g., student, teacher, admin).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Role entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the role (e.g., student, teacher, admin)."
        },
        "description": {
          "type": "string",
          "description": "A description of the role and its permissions."
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "Class": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Class",
      "type": "object",
      "description": "Represents a class, such as 'Class 11' or 'CBSE Class 10'.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Class entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the class (e.g., Class 11)."
        }
      },
      "required": [
        "name"
      ]
    },
    "Subject": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Subject",
      "type": "object",
      "description": "Represents a subject like Physics, Chemistry, or Mathematics.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Subject entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the subject."
        },
        "classId": {
          "type": "string",
          "description": "Reference to the Class this subject belongs to."
        }
      },
      "required": [
        "name",
        "classId"
      ]
    },
    "Content": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Content",
      "type": "object",
      "description": "Represents a piece of learning content, such as a video lecture or study material.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Content entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the content."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the content."
        },
        "type": {
          "type": "string",
          "description": "The type of content, e.g., video or PDF.",
          "enum": [
            "video",
            "pdf"
          ]
        },
        "videoUrl": {
          "type": "string",
          "description": "The URL of the video. Required for 'video' type.",
          "format": "uri"
        },
        "fileUrl": {
          "type": "string",
          "description": "The URL of the PDF file. Required for 'pdf' type.",
          "format": "uri"
        },
        "subjectId": {
          "type": "string",
          "description": "Reference to Subject. (Relationship: Subject 1:N Content)"
        },
        "topicId": {
          "type": "string",
          "description": "Reference to Topic. (Relationship: Topic 1:N Content)"
        },
        "difficultyLevel": {
          "type": "string",
          "description": "The difficulty level of the content.",
          "enum": [
            "Easy",
            "Medium",
            "Hard"
          ]
        },
        "examCategory": {
          "type": "string",
          "description": "Specifies if the content is for JEE Main, Advanced, or both.",
          "enum": [
            "JEE Main",
            "JEE Advanced",
            "Both"
          ]
        },
        "classLevel": {
          "type": "string",
          "description": "Specifies the target class level for the content.",
          "enum": [
            "Class 11",
            "Class 12",
            "Dropper",
            "All"
          ]
        },
        "accessLevel": {
          "type": "string",
          "description": "Specifies if the content is free or requires a subscription.",
          "enum": [
            "free",
            "paid"
          ]
        }
      },
      "required": [
        "title",
        "description",
        "type",
        "subjectId",
        "topicId",
        "difficultyLevel",
        "examCategory",
        "classLevel",
        "accessLevel"
      ]
    },
    "Topic": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Topic",
      "type": "object",
      "description": "Represents a topic or chapter within a subject. Teachers can add and manage topics through the Curriculum page.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Topic entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the topic."
        },
        "description": {
          "type": "string",
          "description": "A description of the topic."
        },
        "subjectId": {
          "type": "string",
          "description": "Reference to Subject. (Relationship: Subject 1:N Topic)"
        }
      },
      "required": [
        "name",
        "description",
        "subjectId"
      ]
    },
    "LiveClass": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LiveClass",
      "type": "object",
      "description": "Represents a live interactive class.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the LiveClass entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the live class."
        },
        "startTime": {
          "type": "string",
          "description": "The date and time the live class starts.",
          "format": "date-time"
        },
        "duration": {
          "type": "number",
          "description": "The duration of the live class in minutes."
        },
        "teacherId": {
          "type": "string",
          "description": "Reference to User (Teacher). (Relationship: User 1:N LiveClass)"
        },
        "teacherName": {
          "type": "string",
          "description": "The name of the teacher conducting the class (denormalized)."
        },
        "teacherPhotoUrl": {
          "type": "string",
          "description": "URL for the teacher's profile picture (denormalized).",
          "format": "uri"
        },
        "meetingUrl": {
          "type": "string",
          "description": "The URL for the video conference meeting.",
          "format": "uri"
        },
        "examCategory": {
          "type": "string",
          "description": "Specifies if the class is for JEE Main, Advanced, or both.",
          "enum": [
            "JEE Main",
            "JEE Advanced",
            "Both"
          ]
        }
      },
      "required": [
        "title",
        "startTime",
        "duration",
        "teacherId",
        "teacherName",
        "meetingUrl",
        "examCategory"
      ]
    },
    "PracticeQuestion": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PracticeQuestion",
      "type": "object",
      "description": "Represents a practice question, which can be a Multiple Choice Question (MCQ) or a Numerical Answer Type question.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the PracticeQuestion entity."
        },
        "questionType": {
          "type": "string",
          "description": "The type of question.",
          "enum": [
            "MCQ",
            "Numerical"
          ]
        },
        "questionText": {
          "type": "string",
          "description": "The text of the practice question."
        },
        "imageUrl": {
          "type": "string",
          "description": "An optional URL for an image associated with the question.",
          "format": "uri"
        },
        "options": {
          "type": "array",
          "description": "An array of 4 multiple choice options. Required for MCQ type.",
          "items": {
            "type": "string"
          },
          "minItems": 4,
          "maxItems": 4
        },
        "correctAnswer": {
          "type": "string",
          "description": "The correct option from the 'options' array. Required for MCQ type."
        },
        "numericalAnswer": {
          "type": "number",
          "description": "The correct numerical answer. Required for Numerical type."
        },
        "difficultyLevel": {
          "type": "string",
          "description": "The difficulty level of the practice question.",
          "enum": [
            "Easy",
            "Medium",
            "Hard"
          ]
        },
        "subjectId": {
          "type": "string",
          "description": "Reference to Subject. (Relationship: Subject 1:N PracticeQuestion)"
        },
        "topicId": {
          "type": "string",
          "description": "Reference to Topic. (Relationship: Topic 1:N PracticeQuestion)"
        },
        "classId": {
          "type": "string",
          "description": "Reference to the Class this question belongs to."
        },
        "examCategory": {
          "type": "string",
          "description": "Specifies if the question is for JEE Main, Advanced, or both.",
          "enum": [
            "JEE Main",
            "JEE Advanced",
            "Both"
          ]
        },
        "accessLevel": {
          "type": "string",
          "description": "Specifies if the question is free or requires a subscription.",
          "enum": [
            "free",
            "paid"
          ]
        }
      },
      "required": [
        "questionType",
        "questionText",
        "difficultyLevel",
        "subjectId",
        "topicId",
        "classId",
        "examCategory",
        "accessLevel"
      ]
    },
    "MockTest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MockTest",
      "type": "object",
      "description": "Represents a mock test created by a teacher.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the MockTest entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the mock test."
        },
        "startTime": {
          "type": "string",
          "description": "The date and time the mock test starts.",
          "format": "date-time"
        },
        "examCategory": {
          "type": "string",
          "description": "Specifies if the test is for JEE Main, Advanced, or both.",
          "enum": [
            "JEE Main",
            "JEE Advanced",
            "Both"
          ]
        },
        "accessLevel": {
          "type": "string",
          "description": "Specifies if the test is free or requires a subscription.",
          "enum": [
            "free",
            "paid"
          ]
        },
        "config": {
          "type": "object",
          "description": "The configuration of the test, specifying questions and duration.",
          "properties": {
            "questionIds": {
              "type": "array",
              "description": "An array of PracticeQuestion IDs to be included in the test.",
              "items": {
                "type": "string"
              }
            },
            "duration": {
              "type": "number",
              "description": "The total duration of the test in minutes."
            }
          },
          "required": [
            "questionIds",
            "duration"
          ]
        }
      },
      "required": [
        "title",
        "startTime",
        "config",
        "examCategory",
        "accessLevel"
      ]
    },
    "SubscriptionPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SubscriptionPlan",
      "type": "object",
      "description": "Defines a subscription plan available for users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the SubscriptionPlan entity (e.g., 'basic', 'pro')."
        },
        "name": {
          "type": "string",
          "description": "The display name of the subscription plan (e.g., 'Pro Plan')."
        },
        "price": {
          "type": "number",
          "description": "The cost of the plan."
        },
        "billingInterval": {
          "type": "string",
          "description": "The billing frequency.",
          "enum": [
            "monthly",
            "yearly"
          ]
        },
        "features": {
          "type": "array",
          "description": "A list of features included in this plan.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "price",
        "billingInterval"
      ]
    },
    "UserSubscription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserSubscription",
      "type": "object",
      "description": "Represents a user's subscription to a specific plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserSubscription entity."
        },
        "planId": {
          "type": "string",
          "description": "Reference to SubscriptionPlan. (Relationship: SubscriptionPlan 1:N UserSubscription)"
        },
        "status": {
          "type": "string",
          "description": "The status of the subscription.",
          "enum": [
            "active",
            "canceled",
            "past_due",
            "trialing"
          ]
        },
        "currentPeriodStart": {
          "type": "string",
          "description": "The start date of the current billing period.",
          "format": "date-time"
        },
        "currentPeriodEnd": {
          "type": "string",
          "description": "The end date of the current billing period.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "planId",
        "status",
        "currentPeriodStart",
        "currentPeriodEnd"
      ]
    },
    "Doubt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Doubt",
      "type": "object",
      "description": "Represents a student's doubt or question.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier." },
        "studentId": { "type": "string", "description": "Reference to the student User." },
        "teacherId": { "type": "string", "description": "Reference to the assigned teacher User." },
        "topicId": { "type": "string", "description": "Reference to the relevant Topic." },
        "question": { "type": "string", "description": "The student's question." },
        "answer": { "type": "string", "description": "The teacher's answer." },
        "status": { "type": "string", "enum": ["open", "answered", "closed"], "description": "The status of the doubt." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the doubt was created." }
      },
      "required": ["studentId", "topicId", "question", "status", "createdAt"]
    },
    "StudentTestResult": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StudentTestResult",
      "type": "object",
      "description": "Stores the results of a student's attempt at a mock test.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier." },
        "testId": { "type": "string", "description": "Reference to the MockTest." },
        "score": { "type": "number", "description": "The final score." },
        "timeTaken": { "type": "number", "description": "Time taken in minutes." },
        "answers": {
          "type": "object",
          "description": "A map of question IDs to the student's answers."
        }
      },
      "required": ["testId", "score", "timeTaken"]
    },
    "CustomMockTest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CustomMockTest",
      "type": "object",
      "description": "Represents a custom mock test created by a student.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier."
        },
        "studentId": {
          "type": "string",
          "description": "Reference to the student User."
        },
        "title": {
          "type": "string",
          "description": "The title of the custom test."
        },
        "accessLevel": {
          "type": "string",
          "description": "Specifies if the test uses free or paid questions.",
          "enum": [
            "free",
            "paid"
          ]
        },
        "config": {
          "type": "object",
          "description": "The configuration of the test, specifying questions and duration.",
          "properties": {
            "questionIds": {
              "type": "array",
              "description": "An array of PracticeQuestion IDs to be included in the test.",
              "items": {
                "type": "string"
              }
            },
            "duration": {
              "type": "number",
              "description": "The total duration of the test in minutes."
            }
          },
          "required": [
            "questionIds",
            "duration"
          ]
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of creation."
        }
      },
      "required": [
        "studentId",
        "title",
        "config",
        "createdAt",
        "accessLevel"
      ]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message in a chat room.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the message." },
        "senderId": { "type": "string", "description": "Reference to the User who sent the message." },
        "senderName": { "type": "string", "description": "Denormalized name of the sender." },
        "senderPhotoUrl": { "type": "string", "description": "Denormalized photo URL of the sender." },
        "text": { "type": "string", "description": "The content of the message." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the message was sent." }
      },
      "required": ["senderId", "senderName", "text", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Path-based ownership ensures only the user or an admin can access this data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/subscriptions/{subscriptionId}",
        "definition": {
          "entityName": "UserSubscription",
          "schema": {
            "$ref": "#/backend/entities/UserSubscription"
          },
          "description": "Stores the user's active subscription details. Path-based ownership ensures privacy.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "subscriptionId",
              "description": "The unique identifier for the subscription record."
            }
          ]
        }
      },
       {
        "path": "/users/{userId}/test_results/{resultId}",
        "definition": {
          "entityName": "StudentTestResult",
          "schema": {
            "$ref": "#/backend/entities/StudentTestResult"
          },
          "description": "Stores results for mock tests taken by the user. Path-based ownership.",
          "params": [
            { "name": "userId", "description": "The user's unique ID." },
            { "name": "resultId", "description": "The unique ID for the test result." }
          ]
        }
      },
      {
        "path": "/users/{userId}/custom_tests/{testId}",
        "definition": {
          "entityName": "CustomMockTest",
          "schema": {
            "$ref": "#/backend/entities/CustomMockTest"
          },
          "description": "Stores custom mock tests created by students. Path-based ownership.",
          "params": [
            {
              "name": "userId",
              "description": "The user's unique ID."
            },
            {
              "name": "testId",
              "description": "The unique ID for the custom test."
            }
          ]
        }
      },
      {
        "path": "/roles/{roleId}",
        "definition": {
          "entityName": "Role",
          "schema": {
            "$ref": "#/backend/entities/Role"
          },
          "description": "Stores role definitions (e.g., student, teacher, admin).",
          "params": [
            {
              "name": "roleId",
              "description": "The unique identifier for the role."
            }
          ]
        }
      },
      {
        "path": "/classes/{classId}",
        "definition": {
          "entityName": "Class",
          "schema": {
            "$ref": "#/backend/entities/Class"
          },
          "description": "Stores class definitions (e.g., Class 11, CBSE Class 10). Teachers can create, update, and delete classes.",
          "params": [
            {
              "name": "classId",
              "description": "The unique identifier for the class."
            }
          ]
        }
      },
      {
        "path": "/subjects/{subjectId}",
        "definition": {
          "entityName": "Subject",
          "schema": {
            "$ref": "#/backend/entities/Subject"
          },
          "description": "Stores subject definitions. Belongs to a class. Teachers can manage subjects.",
          "params": [
            {
              "name": "subjectId",
              "description": "The unique identifier for the subject."
            }
          ]
        }
      },
      {
        "path": "/content/{contentId}",
        "definition": {
          "entityName": "Content",
          "schema": {
            "$ref": "#/backend/entities/Content"
          },
          "description": "Stores learning content, such as video lectures and study materials.",
          "params": [
            {
              "name": "contentId",
              "description": "The unique identifier for the content."
            }
          ]
        }
      },
      {
        "path": "/topics/{topicId}",
        "definition": {
          "entityName": "Topic",
          "schema": {
            "$ref": "#/backend/entities/Topic"
          },
          "description": "Stores topics within the IIT JEE curriculum. Teachers can create, update, and delete topics from the Curriculum page.",
          "params": [
            {
              "name": "topicId",
              "description": "The unique identifier for the topic."
            }
          ]
        }
      },
      {
        "path": "/live_classes/{liveClassId}",
        "definition": {
          "entityName": "LiveClass",
          "schema": {
            "$ref": "#/backend/entities/LiveClass"
          },
          "description": "Stores live class information. Includes denormalized teacherId for authorization independence.",
          "params": [
            {
              "name": "liveClassId",
              "description": "The unique identifier for the live class."
            }
          ]
        }
      },
      {
        "path": "/practice_questions/{practiceQuestionId}",
        "definition": {
          "entityName": "PracticeQuestion",
          "schema": {
            "$ref": "#/backend/entities/PracticeQuestion"
          },
          "description": "Stores practice questions.",
          "params": [
            {
              "name": "practiceQuestionId",
              "description": "The unique identifier for the practice question."
            }
          ]
        }
      },
      {
        "path": "/mock_tests/{mockTestId}",
        "definition": {
          "entityName": "MockTest",
          "schema": {
            "$ref": "#/backend/entities/MockTest"
          },
          "description": "Stores mock test information.",
          "params": [
            {
              "name": "mockTestId",
              "description": "The unique identifier for the mock test."
            }
          ]
        }
      },
      {
        "path": "/roles_teacher/{userId}",
        "definition": {
          "entityName": "teacher",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Documents in this collection indicate that the user with the given ID is a teacher.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the teacher."
            }
          ]
        }
      },
      {
        "path": "/subscription_plans/{planId}",
        "definition": {
          "entityName": "SubscriptionPlan",
          "schema": {
            "$ref": "#/backend/entities/SubscriptionPlan"
          },
          "description": "Stores all available subscription plans. Publicly readable.",
          "params": [
            {
              "name": "planId",
              "description": "The unique identifier for the subscription plan."
            }
          ]
        }
      },
      {
        "path": "/doubts/{doubtId}",
        "definition": {
          "entityName": "Doubt",
          "schema": {
            "$ref": "#/backend/entities/Doubt"
          },
          "description": "Stores student doubts. Students can create, teachers can update/answer.",
          "params": [
            { "name": "doubtId", "description": "The unique ID for the doubt." }
          ]
        }
      },
      {
        "path": "/group_chat_messages/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": {
            "$ref": "#/backend/entities/ChatMessage"
          },
          "description": "Stores all messages for the public group chat.",
          "params": [
            { "name": "messageId", "description": "The unique ID for the chat message." }
          ]
        }
      },
      {
        "path": "/direct_messages/{chatId}/messages/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": {
            "$ref": "#/backend/entities/ChatMessage"
          },
          "description": "Stores messages for a private 1-on-1 chat. The {chatId} is a composite key of the two participant UIDs, sorted alphabetically and joined by an underscore.",
          "params": [
            { "name": "chatId", "description": "The composite ID for the chat room." },
            { "name": "messageId", "description": "The unique ID for the chat message." }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the core features of the DCAM Classes application, focusing on content delivery, live classes, practice questions, mock tests, doubt resolution, personalized learning paths, and progress tracking. The structure prioritizes authorization independence, clarity, and scalability. To achieve Authorization Independence we denormalize data where necessary. For example, teacher information relevant to a LiveClass is accessible without requiring a separate read. Segregation is used extensively to ensure data with different security requirements are stored in different collections, which simplifies the security rules. Path-based ownership is used for user-specific data to easily control access. The use of membership maps are used to support collaborative data access where needed, although in this specific case collaborative data is not explicitly mentioned in the requirements."
  }
}
